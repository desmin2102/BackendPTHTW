<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Danh sách điểm rèn luyện</title>
    <th:block th:replace="~{base :: styles}"></th:block>
</head>
<body>
    <div th:replace="~{base :: header}"></div>
    <div class="content">
        <main class="container mt-4">
            <h1 class="text-center text-success mb-4">Danh sách điểm rèn luyện</h1>

            <!-- Thông tin sinh viên -->
            <div th:if="${sinhVien != null}" class="mb-4">
                <h3 th:text="'Sinh viên: ' + ${sinhVien.ho} + ' ' + ${sinhVien.ten}"></h3>
                <p><strong>MSSV:</strong> <span th:text="${sinhVien.mssv} ?: 'N/A'"></span></p>
            </div>

            <!-- Thông báo lỗi -->
            <div th:if="${error != null}" class="alert alert-danger" th:text="${error}"></div>

            <!-- Bảng điểm rèn luyện -->
            <div th:if="${diemRenLuyenList != null and !diemRenLuyenList.isEmpty()}">
                <table class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Năm học</th>
                            <th>Học kỳ</th>
                            <th>Điểm tổng</th>
                            <th>Xếp loại</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="diem, iterStat : ${diemRenLuyenList}">
                            <td th:text="${iterStat.count}"></td>
                            <td th:text="${diem.hkNh.namHoc}"></td>
                            <td>
                                <th:block th:switch="${diem.hkNh.hocKy != null ? diem.hkNh.hocKy.name : 'UNKNOWN'}">
                                    <span th:case="'ONE'">Học kỳ 1</span>
                                    <span th:case="'TWO'">Học kỳ 2</span>
                                    <span th:case="'THREE'">Học kỳ 3</span>
                                    <span th:case="*">Không xác định</span>
                                </th:block>
                            </td>
                            <td th:text="${diem.diemTong}"></td>
                            <td>
                                <th:block th:switch="${diem.xepLoai != null ? diem.xepLoai.name : 'UNKNOWN'}">
                                    <span th:case="'XUAT_SAC'" class="badge bg-success" th:text="'Xuất sắc'"></span>
                                    <span th:case="'GIOI'" class="badge bg-primary" th:text="'Giỏi'"></span>
                                    <span th:case="'KHA'" class="badge bg-info text-dark" th:text="'Khá'"></span>
                                    <span th:case="'TRUNG_BINH'" class="badge bg-warning text-dark" th:text="'Trung bình'"></span>
                                    <span th:case="'YEU'" class="badge bg-danger" th:text="'Yếu'"></span>
                                    <span th:case="'KEM'" class="badge bg-secondary" th:text="'Kém'"></span>
                                    <span th:case="*" class="badge bg-light text-dark"
                                          th:text="${diem.xepLoai != null ? diem.xepLoai.name : 'Không xác định'}"></span>
                                </th:block>
                            </td>
                            <td>
                                <a th:href="@{/sinh-vien/{sinhVienId}/thanh-tich-chi-tiet(sinhVienId=${diem.sinhVien.id}, diemRenLuyenId=${diem.id}, hknhId=${diem.hkNh.id})}"
                                   class="btn btn-outline-primary btn-sm">Xem chi tiết</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div th:if="${diemRenLuyenList == null or diemRenLuyenList.isEmpty()}" class="alert alert-info">
                Không có điểm rèn luyện nào cho sinh viên này.
            </div>

            <div class="text-center mt-4">
                <a th:href="@{/sinh-vien}" class="btn btn-secondary">Quay lại</a>
            </div>
        </main>
    </div>
    <div th:replace="~{base :: footer}"></div>
    <script src="/webjars/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
</body>
</html>